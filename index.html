<html>
  <link href="https://vjs.zencdn.net/7.4.1/video-js.css" rel="stylesheet" />
  <head>
    <title>Test for ConcertVast</title>
    <style>
      input {
        width: 100%;
        margin: 20px 0;
      }

      video {
        width: 100%;
      }

      .video-js .vjs-tech {
        width: 100%;
      }

      .video-js .vjs-tech {
        height: auto;
      }
    </style>
  </head>
  <body>
    <input
      name="vastUrl"
      value="https://ad.doubleclick.net/ddm/pfadx/N884.154386.EATER.COM/B21643693.231589573;sz=0x0;ord=[timestamp];dc_lat=;dc_rdid=;tag_for_child_directed_treatment=;tfua=;dcmt=text/xml"
    />
    <video class="video-js" width="600px" controls></video>
  </body>
  <script src="https://vjs.zencdn.net/7.4.1/video.js"></script>
  <script>
    var playerObject = videojs(document.querySelector('.video-js'))
    var urlElement = document.querySelector('[name="vastUrl"]')
    var v = new ConcertVast()
    function loadVast(url) {
      v.loadRemoteVast(url).then(r => {
        console.log(v.asHLSUrl())
        console.log('bandwidth:', v.bandwidth())

        var videoElement = document.querySelector('.video-js')

        var firstVideo = v.bestVideo({
          height: videoElement.clientHeight,
          width: videoElement.clientWidth,
        })
        console.log('videos', firstVideo.url(), firstVideo)

        playerObject.src([
          { type: firstVideo.mimeType(), src: firstVideo.url() },
        ])
      })
    }
    loadVast(urlElement.value)

    urlElement.addEventListener('blur', e => {
      loadVast(urlElement.value)
    })
  </script>
</html>
